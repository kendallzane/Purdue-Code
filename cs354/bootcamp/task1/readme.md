Compilation and Environments
=============================

C-Program Compilation
======================

Compiling a C program is a multi-stage process. 
At an overview level, the process can be split into four 
separate stages: Preprocessing, compilation, assembly, and 
linking. [1] 

Compilation
------------
In order to create the assembly level file from the source code,
you can use the following command:
```
gcc -S test_prog.c
```
Running the above command will automatically generate a `.s` file
with the same name as that of the source code file containing the
assembly level instructions

Assembly
---------

During this stage, an assembler is used to translate the assembly
instructions into machine code which will actually be run by the 
target processor. In order to generate machine code(`.o` file) 
from the `.s` assembly level file generated above, you can use the
following instruction:
```
gcc -c test_prog.s
```
The above instruction will generate a `test_prog.o` machine code file

Linking
--------
The result from this stage generates the final executable which
you can generate from the `.o` file generated above using the 
following command:
```
gcc test_prog.o -o test_prog
```
We will use the `-o` flag to name the executable the same as the 
source code file name. If we don't, the resulting executable would
be named `a.out`.


Compilation flags
------------------

GCC provides a myriad of compilation flags which can be used for a 
variety of purposes ranging from displaying warnings from the compiler
, setting the optimization level which will be used to generate the 
final executable, turning on/off certain protections provided by the compiler
to protect from attacks like stack smashing etc. Some of the flags which are
useful to know are detailed below.

- `-m32`: This flag can be passed to the compiler to generate a 32-bit executable
  if you're compiling your program on a 64-bit machine

- `-Wall`: When this flag is passed to the compiler, it'll enable a bunch of 
   warnings about constructions that may be questionable. It's generally
   good practice to enable this flag along with `-Wextra` while 
   compiling programs so as to ensure your code follows good coding 
   practices and has lesser chances of undefined behavior being 
   triggered during execution

- `-O0, -O1, -O2, -O3`: All of these flags respectively specify the different
  level of optimizations that the compiler employs while generating the
  final executable.
  It ranges from `-O0` which means no optimizations are done by the compiler
  and is also the default level of optimization when no optimization flags are
  passed to `-O3` which is one of the more aggressive level of optimization
  that can be employed by the compiler 

C-Programming Environment
==========================

There are bunch of tools that are at your disposal as a programmer to make
your life easier some of which we will dive into below. 

Makefiles
----------

Makefiles are special format files which can be used with GNU `make` utility
to auto-generate executables from the program's source files. 
A basic makefile looks like this:
```
target: dependencies
[tab] system command
```
- `target`: Name of the file that is generated by a program, can be an 
  action like `clean` or name of an object file or an executable

- `dependencies`: Files that are used as input to create the target.

- `system command`: This is the action carried out by the utility
   based on the target which is passed to the make command

Note that it's important that before you type in the system command
you put in a `TAB`. Some of your text editors might have been 
configured to replace tabs with spaces by default which might cause
your `make target` command to cause an error. There are plenty of 
workarounds available on the web which can be used to ensure that
there is a tab before the system command. 

Text Editors
-------------

There are a bunch of text editors and IDE's out there which are highly
configurable based on your own personal taste. The XINU lab provides 
VIM, Emacs, Nano as text editors, any of which can be used while
coding.

Programming Assignment
=======================

Download the tarball (`bootcamp.tar.gz`) and complete the specified objectives. 

- For the given source code(`task1.c`) generate an assembly code file
  (`task1.s`). Make changes to it as specified below:
    - Print `HELLO CS354!` instead of `HELLO WORLD!`
    - Print the above string 10 times instead of 5 times as given in the
      source code
    - Call `bar()` instead of `foo()` from the main function
    - Make the `TEST PASSED` string print by negating the conditional check
      in the assembly code

- Create a makefile from the given template to easen the process of generating
  the assembly code and the final executable

References
===========
[1] https://www.calleerlandsson.com/the-four-stages-of-compiling-a-c-program/
